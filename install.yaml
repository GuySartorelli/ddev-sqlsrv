name: sqlsrv

# List of actions to run before installing the addon.
pre_install_actions:
# Make sure we have a ddev version that can support what we do here
- |
  #ddev-nodisplay
  #ddev-description:Checking DDEV version
  (ddev debug capabilities | grep ddev-get-yaml-interpolation >/dev/null) || (echo "Please upgrade DDEV to v1.21.4+ for appropriate capabilities" && false)
- |
  # Using #ddev-nodisplay tells ddev to be quiet about this action and not show it or its output.
  # https://github.com/microsoft/mssql-docker/issues/734#issuecomment-1382358649
  #ddev-nodisplay
  #ddev-description:Check architecture type for incompatible arm64 type
  if [ "$(arch)" = "arm64" -o "$(arch)" = "aarch64" ]; then
    echo "This package does not work on arm64 machines";
    exit 1;
  fi

# List of files and directories listed that are copied into project .ddev directory.
project_files:
- docker-compose.sqlsrv.yaml
- web-build/Dockerfile.sqlsrv
- config.sqlsrv.yaml

# List of files and directories that are copied into the global .ddev directory.
global_files:

# List of actions to run after installing the addon.
post_install_actions:
# - chmod +x ~/.ddev/commands/web/somecommand
# - touch somefile.${GOOS}.${DDEV_WEBSERVER}
# - perl -pi -e 's/oldstring/newstring/g' docker-compose.addon-template.yaml

# Advanced usage - yaml files can be read in and then used as go template actions
# in pre_install_actions and post_install_actions
# See example in
# https://github.com/rfay/ddev/blob/20220606_yaml_read_experiment/cmd/ddev/cmd/testdata/TestCmdGetComplex/recipe/install.yaml
yaml_read_files:
